import{r as e,j as l,L as S}from"./index-DlvDHybd.js";import{r as n}from"./utils-bN4E_OZW.js";import{B as b}from"./BarChart-Bt1xDp5Q.js";import"./react-apexcharts.min-BdEQ1WFC.js";const v="Solar production",y=e.forwardRef((j,g)=>{const[c,x]=e.useState([]),[E,d]=e.useState(!1),i=e.useRef(!1),C=e.useMemo(()=>{const a=[],r=[],h=[],m=[],f=[],p=[];return c.forEach(t=>{const s=t[3];a.push({x:s,y:n(t[4])}),r.push({x:s,y:n(t[5])}),h.push({x:s,y:n(t[6])}),m.push({x:s,y:n(t[7])}),f.push({x:s,y:n(t[8])}),p.push({x:s,y:n(t[9])})}),[{name:v,data:a},{name:"Battery discharged",data:h},{name:"Battery charged",data:r},{name:"Export to grid",data:f},{name:"Import to user",data:m},{name:"Comsumption",data:p}]},[c]),o=e.useCallback(async()=>{if(i.current)return;i.current=!0;const r=await(await fetch("/yearly-chart")).json();x(r),i.current=!1},[]);e.useImperativeHandle(g,()=>({fetchChart:o}));const u=e.useCallback(()=>{document.hidden||o()},[o]);return e.useEffect(()=>(o(),document.addEventListener("visibilitychange",u),()=>document.removeEventListener("visibilitychange",u)),[o,u]),e.useEffect(()=>{const a=window.matchMedia("(prefers-color-scheme: dark)");a.matches&&d(!0),a.addEventListener("change",r=>d(r.matches))},[]),c.length?l.jsx(b,{series:C,isDark:E}):l.jsx(S,{})});y.displayName="YearlyChart";const D=e.memo(y);export{D as default};
