const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MonthlyChart-D5kDOLOb.js","assets/index-NolOTaoe.js","assets/index-CC--mlv-.css","assets/utils-bN4E_OZW.js","assets/react-apexcharts.min-Cfl3hJIx.js","assets/YearlyChart-C-n9KjJA.js"])))=>i.map(i=>d[i]);
import{j as e,r as t,L as g,_}from"./index-NolOTaoe.js";import{r as h}from"./utils-bN4E_OZW.js";import{C as S}from"./react-apexcharts.min-Cfl3hJIx.js";const d="Solar production";function N({series:s,isDark:a,xaxis:n}){return e.jsx(S,{type:"bar",height:400,series:s,options:{chart:{toolbar:{show:!1},zoom:{allowMouseWheelZoom:!1}},legend:{show:!0,position:"top"},colors:["rgb(112, 173, 70)","rgb(90, 155, 213)","rgb(64, 38, 198)","rgb(246, 104, 103)","rgb(153, 107, 31)","rgb(255, 164, 97)"],theme:{mode:a?"dark":"light"},dataLabels:{enabled:!1},xaxis:n||{type:"category"},tooltip:{x:{format:"dd/MM/yyyy"},y:{formatter(r){return`${r} kWh`}}},yaxis:[{seriesName:d,title:{text:"Energy (kWh)"}},{seriesName:d,show:!1},{seriesName:d,show:!1},{seriesName:d,show:!1},{seriesName:d,show:!1},{seriesName:d,show:!1}]}})}const D="Solar production",w=t.forwardRef((s,a)=>{const[n,r]=t.useState([]),[m,p]=t.useState(!1),y=t.useRef(!1),E=t.useMemo(()=>{const o=[],i=[],f=[],b=[],j=[],v=[];return n.forEach(c=>{const l=new Date(c[3]).getTime();o.push({x:l,y:h(c[4])}),i.push({x:l,y:h(c[5])}),f.push({x:l,y:h(c[6])}),b.push({x:l,y:h(c[7])}),j.push({x:l,y:h(c[8])}),v.push({x:l,y:h(c[9])})}),[{name:D,data:o},{name:"Battery discharged",data:f},{name:"Battery charged",data:i},{name:"Export to grid",data:j},{name:"Import to user",data:b},{name:"Comsumption",data:v}]},[n]),u=t.useCallback(async()=>{if(y.current)return;y.current=!0;const i=await(await fetch("/daily-chart")).json();r(i),y.current=!1},[r]);t.useImperativeHandle(a,()=>({fetchChart:u}));const x=t.useCallback(()=>{document.hidden||u()},[u]);if(t.useEffect(()=>(u(),document.addEventListener("visibilitychange",x),()=>document.removeEventListener("visibilitychange",x)),[u,x]),t.useEffect(()=>{const o=window.matchMedia("(prefers-color-scheme: dark)");o.matches&&p(!0),o.addEventListener("change",i=>p(i.matches))},[]),n.length){const o=new Date,i=new Date(o.getFullYear(),o.getMonth(),1),f=new Date(o.getFullYear(),o.getMonth()+1,0);return e.jsx(N,{series:E,isDark:m,xaxis:{type:"datetime",labels:{datetimeUTC:!1,format:"dd"},min:i.getTime(),max:f.getTime(),stepSize:1}})}return e.jsx(g,{})});w.displayName="DailyChart";const M=t.memo(w),k=t.lazy(()=>_(()=>import("./MonthlyChart-D5kDOLOb.js"),__vite__mapDeps([0,1,2,3,4]))),L=t.lazy(()=>_(()=>import("./YearlyChart-C-n9KjJA.js"),__vite__mapDeps([5,1,2,3,4])));var C=(s=>(s[s.Daily=0]="Daily",s[s.Monthly=1]="Monthly",s[s.Yearly=2]="Yearly",s))(C||{});function R({className:s}){const[a,n]=t.useState(0),r=t.useRef(null);return e.jsxs("div",{className:`card col energy-chart ${s}`,children:[e.jsxs("div",{className:"row justify-space-between",children:[e.jsxs("div",{className:"energy-chart-title",children:[C[a]," chart"]}),e.jsxs("div",{className:"row energy-chart-buttons",children:[e.jsx("button",{onClick:()=>{var m;return(m=r==null?void 0:r.current)==null?void 0:m.fetchChart()},children:"Update chart"}),e.jsx("div",{children:"Chart type:"}),e.jsxs("div",{className:"row chart-select",children:[e.jsx("button",{className:a===0?"active":void 0,onClick:()=>n(0),children:"Daily"}),e.jsx("button",{className:a===1?"active":void 0,onClick:()=>n(1),children:"Monthly"}),e.jsx("button",{className:a===2?"active":void 0,onClick:()=>n(2),children:"Yearly"})]})]})]}),e.jsxs("div",{className:"energy-chart-content flex-1 col",children:[a===0&&e.jsx(M,{ref:r}),a===1&&e.jsx(t.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(k,{ref:r})}),a===2&&e.jsx(t.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(L,{ref:r})})]})]})}const I=t.memo(R),P=Object.freeze(Object.defineProperty({__proto__:null,default:I},Symbol.toStringTag,{value:"Module"}));export{N as B,P as E};
