import{r as t,j as p,L as D}from"./index-DsyW4e9f.js";import{r as n}from"./utils-bN4E_OZW.js";import{B as S}from"./BarChart-BDtvmecX.js";import"./react-apexcharts.min-Cif0XoeI.js";const w="Solar production",g=t.forwardRef((v,y)=>{const[c,x]=t.useState([]),[E,d]=t.useState(!1),h=t.useRef(!1),C=t.useMemo(()=>{const e=[],a=[],i=[],u=[],l=[],f=[];return c.forEach(s=>{const r=new Date(s[3]).getTime();e.push({x:r,y:n(s[4])}),a.push({x:r,y:n(s[5])}),i.push({x:r,y:n(s[6])}),u.push({x:r,y:n(s[7])}),l.push({x:r,y:n(s[8])}),f.push({x:r,y:n(s[9])})}),[{name:w,data:e},{name:"Battery discharged",data:i},{name:"Battery charged",data:a},{name:"Export to grid",data:l},{name:"Import to user",data:u},{name:"Comsumption",data:f}]},[c]),o=t.useCallback(async()=>{if(h.current)return;h.current=!0;const a=await(await fetch("/daily-chart")).json();x(a),h.current=!1},[]);t.useImperativeHandle(y,()=>({fetchChart:o}));const m=t.useCallback(()=>{document.hidden||o()},[o]);if(t.useEffect(()=>(o(),document.addEventListener("visibilitychange",m),()=>document.removeEventListener("visibilitychange",m)),[o,m]),t.useEffect(()=>{const e=window.matchMedia("(prefers-color-scheme: dark)");return e.matches&&d(!0),e.addEventListener("change",a=>d(a.matches)),()=>e.removeEventListener("change",a=>d(a.matches))},[]),c.length){const e=new Date,a=new Date(e.getFullYear(),e.getMonth(),1),i=new Date(e.getFullYear(),e.getMonth()+1,0);return p.jsx(S,{series:C,isDark:E,xaxis:{type:"datetime",labels:{datetimeUTC:!1,format:"dd"},min:a.getTime(),max:i.getTime(),stepSize:1}})}return p.jsx(D,{})});g.displayName="DailyChart";const R=t.memo(g);export{R as default};
