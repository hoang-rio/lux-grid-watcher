const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MonthlyChart-sIDED42n.js","assets/index-Ddo0eE_t.js","assets/index-CC--mlv-.css","assets/utils-bN4E_OZW.js","assets/react-apexcharts.min-DR7JV9TT.js","assets/YearlyChart-Cff73yFA.js"])))=>i.map(i=>d[i]);
import{r as t,j as e,L as p,_}from"./index-Ddo0eE_t.js";import{r as h}from"./utils-bN4E_OZW.js";import{C as S}from"./react-apexcharts.min-DR7JV9TT.js";const d="Solar production";function N({series:s,isDark:r,xaxis:i}){return e.jsx(S,{type:"bar",height:400,series:s,options:{chart:{toolbar:{show:!1},zoom:{allowMouseWheelZoom:!1}},legend:{show:!0,position:"top",horizontalAlign:"left"},colors:["rgb(112, 173, 70)","rgb(90, 155, 213)","rgb(64, 38, 198)","rgb(246, 104, 103)","rgb(153, 107, 31)","rgb(255, 164, 97)"],theme:{mode:r?"dark":"light"},dataLabels:{enabled:!1},xaxis:i||{type:"category"},tooltip:{x:{format:"dd/MM/yyyy"},y:{formatter(o){return`${o} kWh`}}},yaxis:[{seriesName:d,title:{text:"Energy (kWh)"}},{seriesName:d,show:!1},{seriesName:d,show:!1},{seriesName:d,show:!1},{seriesName:d,show:!1},{seriesName:d,show:!1}]}})}const D=t.memo(N),M="Solar production",w=t.forwardRef((s,r)=>{const[i,o]=t.useState([]),[u,y]=t.useState(!1),x=t.useRef(!1),E=t.useMemo(()=>{const a=[],n=[],f=[],b=[],j=[],v=[];return i.forEach(c=>{const l=new Date(c[3]).getTime();a.push({x:l,y:h(c[4])}),n.push({x:l,y:h(c[5])}),f.push({x:l,y:h(c[6])}),b.push({x:l,y:h(c[7])}),j.push({x:l,y:h(c[8])}),v.push({x:l,y:h(c[9])})}),[{name:M,data:a},{name:"Battery discharged",data:f},{name:"Battery charged",data:n},{name:"Export to grid",data:j},{name:"Import to user",data:b},{name:"Comsumption",data:v}]},[i]),m=t.useCallback(async()=>{if(x.current)return;x.current=!0;const n=await(await fetch("/daily-chart")).json();o(n),x.current=!1},[]);t.useImperativeHandle(r,()=>({fetchChart:m}));const g=t.useCallback(()=>{document.hidden||m()},[m]);if(t.useEffect(()=>(m(),document.addEventListener("visibilitychange",g),()=>document.removeEventListener("visibilitychange",g)),[m,g]),t.useEffect(()=>{const a=window.matchMedia("(prefers-color-scheme: dark)");return a.matches&&y(!0),a.addEventListener("change",n=>y(n.matches)),()=>a.removeEventListener("change",n=>y(n.matches))},[]),i.length){const a=new Date,n=new Date(a.getFullYear(),a.getMonth(),1),f=new Date(a.getFullYear(),a.getMonth()+1,0);return e.jsx(D,{series:E,isDark:u,xaxis:{type:"datetime",labels:{datetimeUTC:!1,format:"dd"},min:n.getTime(),max:f.getTime(),stepSize:1}})}return e.jsx(p,{})});w.displayName="DailyChart";const k=t.memo(w),L=t.lazy(()=>_(()=>import("./MonthlyChart-sIDED42n.js"),__vite__mapDeps([0,1,2,3,4]))),R=t.lazy(()=>_(()=>import("./YearlyChart-Cff73yFA.js"),__vite__mapDeps([5,1,2,3,4])));var C=(s=>(s[s.Daily=0]="Daily",s[s.Monthly=1]="Monthly",s[s.Yearly=2]="Yearly",s))(C||{});function I({className:s}){const[r,i]=t.useState(0),o=t.useRef(null);return e.jsxs("div",{className:`card col energy-chart ${s}`,children:[e.jsxs("div",{className:"row justify-space-between",children:[e.jsxs("div",{className:"energy-chart-title",children:[C[r]," chart"]}),e.jsxs("div",{className:"row energy-chart-buttons",children:[e.jsx("button",{onClick:()=>{var u;return(u=o==null?void 0:o.current)==null?void 0:u.fetchChart()},children:"Update chart"}),e.jsx("div",{children:"Chart type:"}),e.jsxs("div",{className:"row chart-select",children:[e.jsx("button",{className:r===0?"active":void 0,onClick:()=>i(0),children:"Daily"}),e.jsx("button",{className:r===1?"active":void 0,onClick:()=>i(1),children:"Monthly"}),e.jsx("button",{className:r===2?"active":void 0,onClick:()=>i(2),children:"Yearly"})]})]})]}),e.jsxs("div",{className:"energy-chart-content flex-1 col",children:[r===0&&e.jsx(k,{ref:o}),r===1&&e.jsx(t.Suspense,{fallback:e.jsx(p,{}),children:e.jsx(L,{ref:o})}),r===2&&e.jsx(t.Suspense,{fallback:e.jsx(p,{}),children:e.jsx(R,{ref:o})})]})]})}const O=t.memo(I),P=Object.freeze(Object.defineProperty({__proto__:null,default:O},Symbol.toStringTag,{value:"Module"}));export{D as B,P as E};
