import{r as e,j as y,L as S}from"./index-NolOTaoe.js";import{r as n}from"./utils-bN4E_OZW.js";import{B as b}from"./EnergyChart-D4UhhD5r.js";import"./react-apexcharts.min-Cfl3hJIx.js";const v="Solar production",g=e.forwardRef((j,x)=>{const[c,d]=e.useState([]),[E,h]=e.useState(!1),i=e.useRef(!1),C=e.useMemo(()=>{const a=[],r=[],m=[],f=[],p=[],l=[];return c.forEach(t=>{const s=t[3];a.push({x:s,y:n(t[4])}),r.push({x:s,y:n(t[5])}),m.push({x:s,y:n(t[6])}),f.push({x:s,y:n(t[7])}),p.push({x:s,y:n(t[8])}),l.push({x:s,y:n(t[9])})}),[{name:v,data:a},{name:"Battery discharged",data:m},{name:"Battery charged",data:r},{name:"Export to grid",data:p},{name:"Import to user",data:f},{name:"Comsumption",data:l}]},[c]),o=e.useCallback(async()=>{if(i.current)return;i.current=!0;const r=await(await fetch("/yearly-chart")).json();d(r),i.current=!1},[d]);e.useImperativeHandle(x,()=>({fetchChart:o}));const u=e.useCallback(()=>{document.hidden||o()},[o]);return e.useEffect(()=>(o(),document.addEventListener("visibilitychange",u),()=>document.removeEventListener("visibilitychange",u)),[o,u]),e.useEffect(()=>{const a=window.matchMedia("(prefers-color-scheme: dark)");a.matches&&h(!0),a.addEventListener("change",r=>h(r.matches))},[]),c.length?y.jsx(b,{series:C,isDark:E}):y.jsx(S,{})});g.displayName="YearlyChart";const D=e.memo(g);export{D as default};
