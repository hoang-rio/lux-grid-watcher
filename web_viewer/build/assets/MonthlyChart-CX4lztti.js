import{r as t,u as S,j as y,L as v}from"./index-CzSImCBt.js";import{r as o}from"./utils-bN4E_OZW.js";import{B as j}from"./BarChart-DPHYGhzz.js";import"./react-apexcharts.min-BqlEK_0A.js";const x=t.forwardRef((D,g)=>{const{t:e}=S(),[i,C]=t.useState([]),[b,d]=t.useState(!1),h=t.useRef(!1),E=t.useMemo(()=>{const r=[],s=[],m=[],f=[],l=[],p=[];return i.forEach(a=>{const n=a[3];r.push({x:n,y:o(a[4])}),s.push({x:n,y:o(a[5])}),m.push({x:n,y:o(a[6])}),f.push({x:n,y:o(a[7])}),l.push({x:n,y:o(a[8])}),p.push({x:n,y:o(a[9])})}),[{name:e("chart.solarProduction"),data:r},{name:e("chart.batteryDischarged"),data:m},{name:e("chart.batteryCharged"),data:s},{name:e("chart.exportToGrid"),data:l},{name:e("chart.importToUser"),data:f},{name:e("chart.consumption"),data:p}]},[i,e]),c=t.useCallback(async()=>{if(h.current)return;h.current=!0;const s=await(await fetch("/monthly-chart")).json();C(s),h.current=!1},[]);t.useImperativeHandle(g,()=>({fetchChart:c}));const u=t.useCallback(()=>{document.hidden||c()},[c]);return t.useEffect(()=>(c(),document.addEventListener("visibilitychange",u),()=>document.removeEventListener("visibilitychange",u)),[c,u]),t.useEffect(()=>{const r=window.matchMedia("(prefers-color-scheme: dark)");r.matches&&d(!0),r.addEventListener("change",s=>d(s.matches))},[]),i.length?y.jsx(j,{series:E,isDark:b}):y.jsx(v,{})});x.displayName="MonthlyChart";const R=t.memo(x);export{R as default};
