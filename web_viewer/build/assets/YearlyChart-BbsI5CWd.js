import{r as e,u as S,j as y,L as v}from"./index-C1awTcI-.js";import{r as o}from"./utils-bN4E_OZW.js";import{B as j}from"./BarChart-Bl7iVqr0.js";import"./react-apexcharts.min-CvRoM8Yq.js";const x=e.forwardRef((D,g)=>{const{t}=S(),[i,C]=e.useState([]),[b,d]=e.useState(!1),h=e.useRef(!1),E=e.useMemo(()=>{const r=[],s=[],m=[],f=[],l=[],p=[];return i.forEach(a=>{const n=a[3];r.push({x:n,y:o(a[4])}),s.push({x:n,y:o(a[5])}),m.push({x:n,y:o(a[6])}),f.push({x:n,y:o(a[7])}),l.push({x:n,y:o(a[8])}),p.push({x:n,y:o(a[9])})}),[{name:t("chart.solarProduction"),data:r},{name:t("chart.batteryDischarged"),data:m},{name:t("chart.batteryCharged"),data:s},{name:t("chart.exportToGrid"),data:l},{name:t("chart.importToUser"),data:f},{name:t("chart.consumption"),data:p}]},[i,t]),c=e.useCallback(async()=>{if(h.current)return;h.current=!0;const s=await(await fetch("/yearly-chart")).json();C(s),h.current=!1},[]);e.useImperativeHandle(g,()=>({fetchChart:c}));const u=e.useCallback(()=>{document.hidden||c()},[c]);return e.useEffect(()=>(c(),document.addEventListener("visibilitychange",u),()=>document.removeEventListener("visibilitychange",u)),[c,u]),e.useEffect(()=>{const r=window.matchMedia("(prefers-color-scheme: dark)");r.matches&&d(!0),r.addEventListener("change",s=>d(s.matches))},[]),i.length?y.jsx(j,{series:E,isDark:b}):y.jsx(v,{})});x.displayName="YearlyChart";const T=e.memo(x);export{T as default};
